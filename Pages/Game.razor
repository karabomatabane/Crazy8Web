@page "/board"
@using Crazy8.Constants
@using Crazy8Web.Utils
<div class="container">
    @if (_players != null && Owner != null)
    {
        <MatChipSet>
            @foreach (Player player in _players)
            {
                <MatChip Label="@GetPlayerName(player)" LeadingIcon="person"
                         Style="@(player == _turn ? "background-color:#4caf50" : "background-color: #e0e0e0")">
                </MatChip>
            }
        </MatChipSet>
        <MatCard class="demo-mat-card">
            <MatCardContent>
                <div class="demo-mat-card-content">
                    <MatHeadline6 class="demo-mat-card-clean-margin center">
                        Table
                    </MatHeadline6>
                </div>

                <div class="card">
                    <img src="assets/cards/back.png" alt="@_faceUp?.Rank of @_faceUp?.Suit">
                    <img src="@_faceUp?.Image" alt="@_faceUp?.Rank of @_faceUp?.Suit">
                    @if (_requireSuit)
                    {
                        <img src="@Utility.GetCardImage(GameService.GetRequiredSuit()!.ToLower())"
                             alt="GameService.GetRequiredSuit()!">
                    }
                </div>
            </MatCardContent>
        </MatCard>

        @if (_myCards != null)
        {
            <MatCard class="demo-mat-card">
                <MatCardContent>
                    <div class="demo-mat-card-content">
                        <MatHeadline6 class="demo-mat-card-clean-margin center">
                            Your Hand
                        </MatHeadline6>
                    </div>

                    <div class="card">
                        @for (int i = 0; i < _myCards.Length; i++)
                        {
                            Card card = _myCards[i];
                            bool isSelected = _tempChoice == i;
                            int pos = i;
                            <img src="@card?.Image" @onclick="() => SelectCard(pos)" 
                                 class="@(IsMyTurn() ? isSelected ? "play-card selected" : "play-card" : "no-play")" alt="@card?.Rank of @card?.Suit">
                        }
                    </div>
                </MatCardContent>
            </MatCard>
            @* <MatSelect Label="Pick a Card" @bind-Value="@_choice"> *@
            @*     @for (int i = 0; i < _myCards.Length; i++) *@
            @*     { *@
            @*         int index = i; *@
            @*         <MatOption TValue="int" Value="@i">@_myCards[index].Rank of @_myCards[index].Suit</MatOption> *@
            @*     } *@
            @* </MatSelect> *@
            @* <MatButton Raised="true" OnClick="PlayChoice" Disabled="!IsMyTurn()">Play</MatButton> *@
            <MatButton Raised="true" OnClick="Skip" Disabled="!IsMyTurn()">Skip</MatButton>
        }
    }
    <MatDialog @bind-IsOpen="@_dialogIsOpen">
        <MatDialogTitle>Crazy 8</MatDialogTitle>
        <MatDialogContent>
            <p>What suit do you want?</p>
            <MatSelectValue Label="Suit" @bind-Value="@_dialogSuit" Items="@Const.Suits" 
                            ValueSelector=@(name=>name)></MatSelectValue>
        </MatDialogContent>
        <MatDialogActions>
            <MatButton OnClick="@OkClick">OK</MatButton>
        </MatDialogActions>
    </MatDialog>
</div>